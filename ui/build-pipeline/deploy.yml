parameters:
- name: subscription
  default: false
- name: destinationBlobContainer
  type: string
- name: cdnProfile
  type: string
- name: cdnResourceGroup
  type: string
- name: cdnName
  type: string


steps:
- task: AzureCLI@2
  displayName: Copy to Blob
  inputs:
    azureSubscription: ${{parameters.subscription}}
    scriptType: 'pscore'
    scriptLocation: 'inlineScript'
    inlineScript: |
      az storage blob upload-batch --destination `$web --account-name ${{parameters.destinationBlobContainer}} --source . --auth-mode login
      az cdn endpoint purge --profile-name ${{parameters.cdnProfile}} -g ${{parameters.cdnResourceGroup}} -n ${{parameters.cdnName}} --content-paths "/*"
    addSpnToEnvironment: true
    workingDirectory: 'ui/build'